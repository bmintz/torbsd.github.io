# Quero ajudar! Como configurar um relay?

	Descritos abaixo, alguns exemplos de instalação e configuração de um ambiente propício para operar um relay Tor. 

	Aqui, nestes exemplos, *NÃO* serão contemplados casos de configuração para bridges ou nós de saída. Outro documento 
	deverá descrever estas outras alternativas de relay. Aqui também ainda não estão sendo contemplados meios de 
	transporte alternativos que podem ser utilizados na rede Tor (obfuscadores de tráfego, ou Pluggable Transports).

		* Exeplos de obfuscadores de tráfego?

			~ obfs4proxy
			~ meek

	Dando continuidade a configuração de seu relay, recomenda-se uma implementação própria e ajustes finos nas máquinas 
	que você pretende utilizar como relay; é importante que elas estejam prezando pelo anonimato dos usuários que através 
	dela trafegam.

		* O que pode se entender por ajustes finos?

			~ blocos de endereços IP dedicados para uso do relay;
			~ serviços distintos separados por VLAN;
			~ preferencialmente utilizar uma máquina física;

				+ implementação plenamente dedicada a operar relays, nós de saída ou bridges
				+ diferentes versões do Tor disponíveis em diferentes sistemas operacionais, ou arquiteturas
				+ não executar várias instâncias do Tor em um ambiente compartilhado

			~ evitar utilização de NAT, sempre que possível;

				+ há um limite máximo/recomendado de 2 daemons compartilhando mesmo IP público

			~ caso possível, encriptar os sistemas de arquivo utilizados;
			~ NTP? procure implementar seu próprio Stratum 1 (GPS);

	Talvez o ponto mais fraco, e esquecido/ignorado por várias pessoas, está ligado ao uso "indevido" de servidores DNS!

	Sempre preze pelo seu próprio setup de DNS. Precisa de ajuda? Veja material disponível em https://github.com/isislovecruft/scripts.
	Outro material que pode ser considerado está disponível na página do projeto DNS Crypt Proxy (https://www.dnscrypt.org). 

	Procure ler um pouco sobre estas e outras possibilidades de configuração, e implemente a solução de DNS que melhor lhe convem 
	(prezando pelos usuários da rede, e a privicidade de todos). Um pouco mais sobre DNS? https://www.opennic.org 

		* Combinar seu cenário dedicado com DNS Crypt?

			~ unbound
			~ bind
			~ dnsmasq
			~ pdnsd

	Dependendo do cenário onde se encontra a máquina que você decide "doar" para ser utilizada como relay, pode ser 
	necessário que você configure redirecionamento de portas. Por favor, procure informações adicionais de como realizar 
	este tipo de procedimento ou configuração adicional.

		-------------------------------------------------------------------------------------------------
		sempre revise o arquivo de confiração padrão (https://openbsd-br.org/tor/pt/torrc) que está sendo 
		utilizado neste documento; ele pode conter informações meramente fictícias que não correspondem 
		ao seu cenário, ou pode utilizar caminhos diferentes referentes a configuração do DataDir ou Log.
		-------------------------------------------------------------------------------------------------

	## DragonFlyBSD

	Supondo um sistema atualizado (5.0.0 X86_64_GENERIC), já com 'pkg' disponível:

		usuario$ su - 
		Password:
		root# pkg install -y tor
		root# fetch http://openbsd-br.org/tor/pt/torrc -o /usr/local/etc/tor/torrc
		root# echo "tor_enable=YES" >> /etc/rc.conf
		root# echo "net.inet.ip.random_id=1" >> /etc/sysctl.conf
		root# sysctl net.inet.ip.random_id=1
		root# service tor start

	## FreeBSD

	Supondo um sistema sem pacotes adicionais instalados e atualizado (11.1-RELEASE-p2 GENERIC):

		usuario$ su - 
		Password:
		root# env ASSUME_ALWAYS_YES=yes pkg bootstrap
		root# pkg install -y tor
		root# fetch http://openbsd-br.org/tor/pt/torrc -o /usr/local/etc/tor/torrc
		root# sysrc tor_enable=YES
		root# echo "net.inet.ip.random_id=1" >> /etc/sysctl.conf
		root# sysctl net.inet.ip.random_id=1
		root# service tor start

	## NetBSD

	Supondo um sistema sem pacotes adicionais instalados e atualizado (7.1 GENERIC), já com 'pkgin' disponível:

		usuario$ su - 
		Password:
		root# pkgin -y install tor
		root# ftp -o /usr/pkg/etc/tor/torrc http://openbsd-br.org/tor/pt/torrc
		root# ln -sf /usr/pkg/share/examples/rc.d/tor /etc/rc.d/tor
		root# echo "tor=YES" >> /etc/rc.conf
		root# /etc/rc.d/tor start

	## OpenBSD

	Supondo um sistema sem pacotes adicionais instalados e atualizado (6.2 GENERIC):

		usuario$ su - 
		Password:
		root# echo "https://ftp.openbsd.org/pub/OpenBSD" > /etc/installurl
		root# pkg_add tor
		root# ftp -o /etc/tor/torrc http://openbsd-br.org/tor/pt/torrc
		root# rcctl enable tor 
		root# rcctl set tor flags "-f /etc/tor/torrc -User _tor"
		root# /etc/rc.d/tor start 

